var j=Object.defineProperty;var P=(r,e,t)=>e in r?j(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var x=(r,e,t)=>(P(r,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const m of i.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&n(m)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();function E(r){return document.querySelector(r)}function y(r){return r.map(e=>parseInt(e)).filter(e=>!isNaN(e))}const g={default:["output-item"],error:["output-item","error"],hint:["output-item","hint"]},w=E(".commandOutput"),v=r=>e=>{const t=document.createElement("p");t.classList.add(...r),t.innerText=e+`
`,w.appendChild(t),w.scrollTop=w.scrollHeight},O=v(g.default),L=v(g.error),k=v(g.hint),h=new Map;function F(r){O(`$ ${r}`);const e=r.split(" "),t=e[0].toLowerCase(),n=e.slice(1),s=h[t];if(!s)return L(`Unknown command: ${t}`);try{let i=s(n);i!==void 0&&O(i)}catch(i){i instanceof Error&&console.error(i),L(i)}}function l(r,e,t){let n=[].concat(r).map(s=>s.toLowerCase());t.description=e,n.forEach(s=>h[s]=t)}function d(r,e,t){if(r.length<e)throw"Usage: "+t}l("help","shows a list of all commands",()=>{let r=Object.keys(h).sort(),e=r.reduce((t,n)=>Math.max(t,n.length),0);return r.map(t=>`${t}${" ".repeat(e-t.length)} : ${h[t].description}`).join(`
`)});function S(r){let e=new p(r.name);return r.children.map(n=>{if(n.type==="f")return _(n);if(n.type==="d")return S(n)}).forEach(n=>e.add(n)),e}function _(r){return new I(r.name,r.content)}const b=class{constructor(e,t){this._id=b.nextID++,this.name=e,this.type=t}static deserialize(e){return e?S(e):new p("")}getPath(){let e="",t=this;for(;t;)e=t.name+"/"+e,t=t.parent;return e}};let u=b;x(u,"nextID",0);class p extends u{constructor(e){super(e,"d"),this.children=[]}get(e){return this.children.find(t=>t.name===e)}exists(e){return!!this.get(e)}add(e){return this.exists(e.name)||e.parent?!1:(Object.defineProperty(e,"parent",{value:this}),this.children.push(e),!0)}remove(e){let t=this.children.findIndex(n=>n._id===e._id);t>-1&&this.children.splice(t,1)}}class I extends u{constructor(e,t){super(e,"f"),this.content=t||""}erase(){this.content=""}write(e){this.content=e}append(e){this.write(this.content+e)}}const a={dirname:r=>r.substr(0,r.lastIndexOf("/"))||"/",basename:r=>r.substr(r.lastIndexOf("/")+1),join:(r,e)=>r+(r.endsWith("/")?"":"/")+e};class f{constructor(e=new p(""),t="/"){this.root=e,this.pwd=t,(!this.exists(this.pwd)||this.get(this.pwd).type!=="d")&&(this.pwd="/")}static deserialize(e){return e?new f(u.deserialize(e.root),e.pwd):new f}_resolve(e){let t=e,n=this.pwd;if(t===".")return n;if(t==="..")return a.dirname(n);for(t.startsWith("./")&&(t=t.substr(2));t.startsWith("../");)t=t.substr(3),n=a.dirname(n);return t.startsWith("/")||(t=a.join(n,t)),t}get(e){let n=this._resolve(e).substr(1).split("/"),s=this.root;for(;n.length;){let i=n.shift();if(i&&(s=s.get(i),!s||n.length>0&&s.type!=="d"))return}return s}exists(e){return!!this.get(e)}touch(e){if(this.exists(e))return;let t=this.get(a.dirname(this._resolve(e)));!t||!t.type==="d"||t.add(new I(a.basename(e)))}mkdir(e){if(this.exists(e))return;let t=this.get(a.dirname(this._resolve(e)));!t||!t.type==="d"||t.add(new p(a.basename(e)))}readDir(e){let t=this.get(e);if(!(!t||t.type!=="d"))return t.children}readFile(e){let t=this.get(e);if(!(!t||t.type!=="f"))return t.content}writeFile(e,t){let n=this.get(e);!n||n.type!=="f"||n.write(t)}appendFile(e,t){let n=this.get(e);!n||n.type!=="f"||n.append(t)}delete(e){let t=this.get(e);!t||!t.parent||t.parent.remove(t)}}const N="online-terminal-state";let o={fs:new f};function $(){const r=localStorage.getItem(N);if(r)try{const e=JSON.parse(r);o={fs:f.deserialize(e.fs)}}catch{}}function T(){localStorage.setItem(N,JSON.stringify(o))}l("cd","changes the current working directory to a different folder",r=>{d(r,1,"cd <folder>");let e=o.fs._resolve(r[0]),t=o.fs.get(e);if(t&&t.type==="d")o.fs.pwd=e;else throw'The folder "'+e+'" does not exist!';return e});l("pwd","shows the current working directory",()=>o.fs.pwd||"/");l("ls","lists all files in the current directory",r=>o.fs.readDir(r[0]||"").map(e=>e.name+(e.type==="d"?"/":"")).join(`
`));l("touch","creates or updates the timestamp for the given file",r=>d(r,1,"touch <file>")||o.fs.touch(r[0]));l("mkdir","makes a new directory",r=>d(r,1,"mkdir <folder>")||o.fs.mkdir(r[0]));l("cat","outputs the contents of a file",r=>d(r,1,"cat <file>")||o.fs.readFile(r[0]));l("write","writes the given contents to a file",r=>d(r,1,"write <file> [contents]")||o.fs.writeFile(r[0],r.slice(1).join(" ")+`
`));l("append","appends the given contents to a file",r=>d(r,1,"append <file> [contents]")||o.fs.appendFile(r[0],r.slice(1).join(" ")+`
`));l("rm","removes a file",r=>d(r,1,"rm <path>")||o.fs.delete(r[0]));l(["add","+"],"adds two or more numbers",r=>y(r).reduce((e,t)=>e+t,0));l(["subtract","-"],"subtracts two or more numbers",r=>{let e=y(r),t=e.shift();return e.reduce((n,s)=>n-s,t)});l(["multiply","*"],"multiplies two or more numbers",r=>y(r).reduce((e,t)=>e*t,1));let c;window.addEventListener("load",()=>{$(),c=E(".commandInput"),c.focus(),c.addEventListener("keydown",({key:r})=>{r==="Enter"&&c.value&&(F(c.value),c.value="")}),k('Hint: Type "help" for a list of commands.')});window.addEventListener("unload",()=>T());
